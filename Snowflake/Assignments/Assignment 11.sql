USE ROLE ACCOUNTADMIN;
USE DATABASE DEMO_DB;
USE WAREHOUSE COMPUTE_WH;

CREATE OR REPLACE TABLE DEMO_DB.PUBLIC.SUPPLIER
AS
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."SUPPLIER";

--CLONE A TABLE

CREATE OR REPLACE TABLE SUPPLIER_CLONE
CLONE SUPPLIER;

--UPDATE TABLE
UPDATE SUPPLIER_CLONE
SET S_PHONE='###';--01af2a58-0604-c01f-0000-ff5b00014266

CREATE OR REPLACE TABLE SUPPLIER_CLONE_CLONE
CLONE SUPPLIER_CLONE BEFORE (STATEMENT => '01af2a58-0604-c01f-0000-ff5b00014266');

DROP TABLE SUPPLIER;

SELECT COUNT(1) FROM SUPPLIER_CLONE; --10,000
SELECT COUNT(1) FROM SUPPLIER_CLONE_CLONE; --10,000