CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;

CREATE OR REPLACE TABLE CUSTOMERS
(NO INT AUTOINCREMENT START =1 INCREMENT BY 1,
NAME STRING DEFAULT 'TAMIL',
CREATED_TS TIMESTAMP);



SHOW TABLES;

--CREATE TASK
CREATE OR REPLACE TASK CUSTOMER_TASK -- BY DEFAULT THIS WILL BE IN SUSPEND STATE
WAREHOUSE = COMPUTE_WH
SCHEDULE = '1 MINUTE' --ALWAYS IN MINUTE
AS
INSERT INTO CUSTOMERS (CREATED_TS) VALUES (CURRENT_TIMESTAMP);

SHOW TASKS;

--RESUME/SUSPEND TASK
ALTER TASK CUSTOMER_TASK RESUME;
ALTER TASK CUSTOMER_TASK SUSPEND;

SELECT * FROM CUSTOMERS;
